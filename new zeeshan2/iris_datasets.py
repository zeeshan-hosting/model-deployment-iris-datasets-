# -*- coding: utf-8 -*-
"""iris datasets

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1MkHVNDL7uN1a6fl0SzLtAP_HJfegw1Mp
"""

import numpy as np
import matplotlib.pyplot as plt
import pandas as pd 
import pickle
import seaborn as sns

df=pd.read_csv("Iris.csv")

df.head()

del df["Id"]  # deleting id column

df.head()

df.describe()

df.info()

df["Species"].value_counts()

"""## preprocessing the data"""

df.isnull().sum()

"""## EDA"""

df.columns

# PLOTTING THE HISTOGRAM OF EACH COLUMN:

for i in df.columns:
  print(i)
  plt.figure(figsize=(5,5))
  plt.hist(df[i])
  plt.show()

"""## correlation matrix"""

df.corr()

sns.heatmap(df.corr(),annot=True)

"""## label encoder"""

from sklearn.preprocessing import LabelEncoder
le=LabelEncoder()
df["Species"]=le.fit_transform(df["Species"])

df.head()

df[df["Species"]==1]

"""## model training"""

X=df.iloc[:,:-1]
y=df["Species"]

X.head()

y.head()

from sklearn.model_selection import train_test_split
X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.30,random_state=0)

X_train.shape,X_test.shape,y_train.shape,y_test.shape

"""## logistic regression"""

from sklearn.linear_model import LogisticRegression
classifier=LogisticRegression()

# model training

classifier.fit(X_train,y_train)

from sklearn import metrics
con_mat=metrics.confusion_matrix(y_test,y_pred)
con_mat

y_pred=classifier.predict(X_test)

print("Accuracy:",metrics.accuracy_score(y_test, y_pred))

# performance of the model:
print("accuracy:",classifier.score(X_test,y_test)*100)

classifier.predict(df.iloc[68:75,:-1])

'''from sklearn.externals import joblib
joblib.dump(classifier,"model_pkl")
mj=joblib.load("model_pkl")'''

'''mj.predict(df.iloc[68:75,:-1])'''

pickle.dump(classifier,open("model.pkl","wb"))
model=pickle.load(open("model.pkl","rb"))

print(model.predict(df.iloc[68:75,:-1]))

